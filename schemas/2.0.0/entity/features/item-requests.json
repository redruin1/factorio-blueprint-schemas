{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "2.0.0/entity/features/item-requests.json",
    "title": "Item Requests",
    "description": "Allows this entity to request items on construction to one or more of it's inventories.",
    "$defs": {
        "inventory-location": {
            "title": "Inventory Location",
            "description": "Where and how much of the item should be requested. In Factorio, the order of delivered items in entity inventories was entirely arbitrary, being decided by the order in which bots delivered the requested items. In Factorio 2.0, inventory slot positions are now preserved and defined using the `'stack'` property.",
            "type": "object",
            "properties": {
                "inventory": {
                    "title": "Inventory Index",
                    "description": "Which inventory this item should be requested to, 1-indexed. See [`inventory`](https://lua-api.factorio.com/latest/defines.html#defines.inventory).",
                    "$ref": "../../../common/uint32.json",
                    "default": 1
                },
                "stack": {
                    "title": "Inventory Slot",
                    "description": "Which slot in the specified inventory this item should occupy, 0-indexed. The item request is ignored if this slot lies beyond the number of available slots for this inventory.",
                    "$ref": "../../../common/uint32.json",
                    "default": 0
                },
                "count": {
                    "title": "Count",
                    "description": "How much of the item should be requested to this slot.",
                    "$ref": "../../../common/uint32.json",
                    "default": 1
                }
            }
        },
        "item-id": {
            "title": "Item ID",
            "description": "The particular item being requested. Must be a valid Factorio item.",
            "type": "object",
            "properties": {
                "name": {"type": "string"},
                "quality": {"$ref": "../../common/quality-name.json"}
            },
            "required": ["name"]
        },
        "item-specification": {
            "title": "Item Specification",
            "description": "All places/positions where this item is requested to.",
            "type": "object",
            "properties": {
                "in_inventory": {
                    "title": "Inventory Locations",
                    "description": "A list of unique positions inside of one or more of this entity's inventories where the requested item should occupy.",
                    "type": "array",
                    "items": {"$ref": "#/$defs/inventory-location"}
                },
                "grid_count": {
                    "title": "Grid Count",
                    "description": "The count of this item inside of this entity's equipment grid. Exactly where in the equipment grid they are located is defined by the `'grid'` key on applicable entities. If the entity does not have an equipment grid, this value is always 0.",
                    "$ref": "../../../common/uint32.json",
                    "default": 0
                }
            },
            "default": {}
        },
        "item-request": {
            "title": "Item Request",
            "description": "All item requests for a particular item type.",
            "type": "object",
            "properties": {
                "id": {"$ref": "#/$defs/item-id"},
                "items": {"$ref": "#/$defs/item-specification"}
            },
            "examples": [
                {
                    "id": {"name": "personal-roboport", "quality": "rare"},
                    "items": {
                        "in_inventory": [
                            {
                                "inventory": 3,
                                "stack": 5,
                                "count": 10
                            }
                        ],
                        "grid_count": 1
                    }
                }
            ]
        }
    },
    "type": "object",
    "properties": {
        "items": {
            "title": "Item Request List",
            "description": "A list of item requests objects, which contain the item name, it's quality, the amount to request, as well as exactly what inventories to request to and where inside those inventories.",
            "type": "array",
            "items": {
                "$ref": "#/$defs/item-request"
            }
        }
    }
}